"use strict";var ReactCSSTransitionGroup=React.addons.CSSTransitionGroup,Panel=React.createClass({displayName:"Panel",getDefaultProps:function(){return{type:"default",heading:"",body:"",footer:"",footerClick:null,headerClick:null}},render:function(){var a=null;this.props.heading&&(a=React.createElement("div",{className:"panel-heading",onClick:this.props.headerClick},this.props.heading));var b=null;this.props.body&&(b=React.createElement("div",{className:"panel-body"},this.props.body));var c=null;this.props.footer&&(c=React.createElement("div",{className:"panel-footer",onClick:this.props.footerClick},this.props.footer));var d="panel panel-"+this.props.type;return React.createElement("div",{className:d},a,React.createElement(ReactCSSTransitionGroup,{transitionName:"expand",transitionEnterTimeout:500,transitionLeaveTimeout:500},b),c)}}),BreakIt=function(a){if("undefined"==typeof a)throw"BreakIt text parameter is undefined";var b=a.split("\n").map(function(a,b){return React.createElement("span",{key:b},a,React.createElement("br",null))});return b},AbstainButton=function(a){return React.createElement("div",{className:"btn btn-warning btn-lg",onClick:a.handleClick},"Abstain from ",a.title," ",React.createElement("i",{className:"fa fa-arrow-right"}))},_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},Review=React.createClass({displayName:"Review",getDefaultProps:function(){return{election:{},singleVote:[],multipleVote:[],referendumVote:[],resetStage:null}},render:function(){var a=null;this.props.singleVote.length>0&&(a=React.createElement(SingleResult,{vote:this.props.singleVote,resetStage:this.props.resetStage}));var b=null;this.props.multipleVote.length>0&&(b=React.createElement(MultipleResult,{vote:this.props.multipleVote,resetStage:this.props.resetStage}));var c=null;return this.props.referendumVote.length>0&&(c=React.createElement(ReferendumResult,{vote:this.props.referendumVote,resetStage:this.props.resetStage})),React.createElement("div",null,React.createElement("h2",null,"Review"),React.createElement("div",{className:"review-warning"},React.createElement("p",null,"You're almost done"),React.createElement("p",null,"Since you may only vote once, let's review your selections.")),React.createElement("div",{className:"text-center"},React.createElement("button",{className:"btn btn-lg btn-block btn-success",onClick:this.props.finalVote},"Place my Vote")),React.createElement("div",null,"Â "),React.createElement("div",{className:"vote-results"},a,b,c),React.createElement("div",{className:"text-center"},React.createElement("button",{className:"btn btn-lg btn-block btn-success",onClick:this.props.finalVote},"Place my Vote")))}}),SingleResult=React.createClass({displayName:"SingleResult",getDefaultProps:function(){return{vote:[],resetStage:null}},render:function(){var a=this.props.vote.map(function(a,b){return React.createElement(SingleResultRow,_extends({key:b},a,{resetStage:this.props.resetStage.bind(null,"single",a.single.id)}))}.bind(this));return React.createElement("div",null,a)}}),SingleResultRow=React.createClass({displayName:"SingleResultRow",getDefaultProps:function(){return{vote:{},resetStage:null,single:{},ticket:{}}},render:function(){var a=React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-10"},React.createElement("h3",null,this.props.single.title)),React.createElement("div",{className:"col-xs-2"},React.createElement("button",{className:"btn btn-block btn-default",onClick:this.props.resetStage.bind(null,"single",this.props.single.id)},React.createElement("i",{className:"fa fa-pencil"})," Edit")));if(this.props.ticket)var b=React.createElement("i",{className:"fa fa-check-circle text-success fa-5x pull-right"}),c=React.createElement("h4",null,this.props.ticket.title),d=this.props.ticket.candidates.map(function(a,b){return React.createElement("div",{className:"pull-left pad-right",key:b},React.createElement(SingleCandidate,a))});else var b=null,c=React.createElement("h4",null,"No ticket chosen"),d=React.createElement("p",null,"Abstained");var e=React.createElement("div",null,b,c,React.createElement("div",null,d));return React.createElement(Panel,{heading:a,body:e})}}),MultipleResult=React.createClass({displayName:"MultipleResult",getDefaultProps:function(){return{vote:[],resetStage:null}},render:function(){var a=this.props.vote.map(function(a,b){return React.createElement(MultipleResultRow,_extends({},a,{key:b,resetStage:this.props.resetStage}))}.bind(this)),b=React.createElement("h3",null,"Senate Seats"),c=React.createElement("div",null,a);return React.createElement(Panel,{heading:b,body:c})}}),MultipleResultRow=React.createClass({displayName:"MultipleResultRow",getDefaultProps:function(){return{chairs:[],multiple:{},resetStage:null}},render:function(){var a=React.createElement("div",{className:"row"},React.createElement("div",{className:"col-xs-10"},React.createElement("h4",null,this.props.multiple.title)),React.createElement("div",{className:"col-xs-2"},React.createElement("button",{className:"btn btn-default btn-block",onClick:this.props.resetStage.bind(null,"multiple",this.props.multiple.id)},React.createElement("i",{className:"fa fa-pencil"})," Edit")));if(0===this.props.chairs.length)var b=React.createElement("div",null,React.createElement("h4",null,"No candidates chosen."),React.createElement("p",null,"Abstained."));else var c=this.props.multiple.candidates.map(function(a,b){return-1!==$.inArray(a.id,this.props.chairs)?React.createElement(MultipleCandidateRow,_extends({},a,{key:b})):void 0}.bind(this)),b=React.createElement("ul",{className:"list-group"},c);var d=React.createElement("div",{className:"multiple-ticket-vote"},b);return React.createElement(Panel,{heading:a,body:d})}}),MultipleCandidateRow=React.createClass({displayName:"MultipleCandidateRow",getDefaultProps:function(){return{firstName:"",lastName:"",picture:""}},render:function(){var a=React.createElement("i",{className:"pull-right text-success fa fa-check-circle fa-2x"}),b=React.createElement("img",{className:"img-circle",src:"mod/election/img/no-picture.gif"});return this.props.picture.length>0&&(b=React.createElement("img",{className:"img-circle",src:this.props.picture})),React.createElement("li",{className:"list-group-item",onClick:this.props.select},a,b,this.props.firstName," ",this.props.lastName)}}),ReferendumResult=React.createClass({displayName:"ReferendumResult",getDefaultProps:function(){return{vote:[],resetStage:null}},getInitialState:function(){return{}},render:function(){var a=this.props.vote.map(function(a,b){return React.createElement(ReferendumResultRow,_extends({key:b},a,{resetStage:this.props.resetStage}))}.bind(this)),b=React.createElement("h3",null,"Referenda"),c=React.createElement("div",null,a);return React.createElement(Panel,{heading:b,body:c})}}),ReferendumResultRow=React.createClass({displayName:"ReferendumResultRow",getDefaultProps:function(){return{}},render:function(){var a="";switch(this.props.answer){case"yes":a=React.createElement("span",{className:"text-success"},React.createElement("i",{className:"fa fa-check-circle"})," Yes");break;case"no":a=React.createElement("span",{className:"text-danger"},React.createElement("i",{className:"fa fa-times-circle"})," No");break;case"abstain":a=React.createElement("span",{className:"text-primary"},React.createElement("i",{className:"fa fa-question-circle"})," Abstain")}return React.createElement("div",{className:"row referendum-result"},React.createElement("div",{className:"col-sm-6"},this.props.referendum.title),React.createElement("div",{className:"col-sm-3"},a),React.createElement("div",{className:"col-sm-3"},React.createElement("button",{className:"btn btn-block btn-default",onClick:this.props.resetStage.bind(null,"referendum",this.props.referendum.id)},React.createElement("i",{className:"fa fa-pencil"})," Edit")))}}),Referendum=React.createClass({displayName:"Referendum",getDefaultProps:function(){return{election:{},updateVote:null,vote:[],referendum:{}}},render:function(){var a=React.createElement("h2",null,this.props.referendum.title),b=BreakIt(this.props.referendum.description),c=React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-4"},React.createElement("button",{className:"btn btn-block btn-lg btn-default",onClick:this.props.updateVote.bind(null,"yes")},React.createElement("i",{className:"fa fa-check"})," Yes")),React.createElement("div",{className:"col-sm-4"},React.createElement("button",{className:"btn btn-block btn-lg btn-default",onClick:this.props.updateVote.bind(null,"no")},React.createElement("i",{className:"fa fa-times"})," No")),React.createElement("div",{className:"col-sm-4"},React.createElement("button",{className:"btn btn-block btn-lg btn-default",onClick:this.props.updateVote.bind(null,"abstain")},"Abstain")));return React.createElement(Panel,{heading:a,body:b,footer:c})}}),_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},Multiple=React.createClass({displayName:"Multiple",getDefaultProps:function(){return{election:{},updateVote:null,vote:[],ballot:{},unqualified:[],supportLink:null}},render:function(){return React.createElement(MultipleBallot,_extends({multipleId:this.props.ballot.id},this.props.ballot,{updateVote:this.props.updateVote,vote:this.props.vote,unqualified:this.props.unqualified,supportLink:this.props.supportLink}))}}),MultipleBallot=React.createClass({displayName:"MultipleBallot",getInitialState:function(){return{selectedRows:[],totalSelected:0}},getDefaultProps:function(){return{updateVote:null,seatNumber:2,title:null,candidates:[],vote:null,multipleId:0,supportLink:null}},select:function(a){var b=this.state.selectedRows,c=$.inArray(a,b),d=this.state.totalSelected,e=1*this.props.seatNumber;-1===c?d!==e&&(d++,b.push(a)):(d>0&&d--,b.splice(c,1)),this.setState({selectedRows:b,totalSelected:d})},saveVotes:function(){this.props.updateVote(this.state.selectedRows),this.setState({selectedRows:[],totalSelected:0})},render:function(){var a=(1*this.props.seatNumber,this.props.candidates.map(function(a){if(-1!==$.inArray(a.id,this.state.selectedRows))var b=!0;else var b=!1;return React.createElement(MultipleCandidate,_extends({key:a.id},a,{selected:b,select:this.select.bind(null,a.id)}))}.bind(this)));if(this.state.totalSelected>0)var b=React.createElement("button",{className:"pull-right btn btn-success",onClick:this.saveVotes},"Continue ",React.createElement("i",{className:"fa fa-arrow-right"}));else var b=React.createElement("button",{className:"pull-right btn btn-warning",onClick:this.saveVotes},"Abstain from ",this.props.title," ",React.createElement("i",{className:"fa fa-arrow-right"}));var c=null;if(this.props.unqualified.length>0){var d="mailto:"+this.props.supportLink;c=React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-6"},React.createElement("p",null,"You were not qualified to vote in the following ballots because of your class, college, or organizational affiliation."),React.createElement("ul",null,this.props.unqualified.map(function(a,b){return React.createElement("li",{key:b},a)}))),React.createElement("div",{className:"col-sm-6 well"},React.createElement("div",{className:"alert alert-danger"},React.createElement("strong",null,"Is there ballot you should be able to vote on?")),React.createElement("ol",null,React.createElement("li",null,"STOP! Do not complete your vote"),React.createElement("li",null,React.createElement("a",{href:d},React.createElement("strong",null,"click here")," and email your ASU username and the missing ballot name."))),React.createElement("p",null,"We will check your account and get back to you.")))}return React.createElement("div",{className:"multiple-ticket-vote"},React.createElement("h2",null,this.props.title),React.createElement("div",{className:"container remaining-seats alert alert-success"},b,"You have selected ",this.state.totalSelected," of the allowed ",this.props.seatNumber," seat","1"===this.props.seatNumber?null:"s","."),React.createElement("ul",{className:"list-group"},a),React.createElement("hr",null),React.createElement("div",null,b),React.createElement("div",{style:{clear:"both"}},c))}}),MultipleCandidate=React.createClass({displayName:"MultipleCandidate",getInitialState:function(){return{}},getDefaultProps:function(){return{firstName:"",lastName:"",picture:"",title:"",selected:!1,select:null}},render:function(){if(this.props.selected)var a="list-group-item pointer active",b=React.createElement("button",{className:"pull-right btn btn-default btn-lg"},React.createElement("i",{className:"fa fa-check"})," Selected");else var a="list-group-item pointer",b=React.createElement("button",{className:"pull-right btn btn-default btn-lg"},"Select");var c=React.createElement("img",{className:"img-circle",src:defaultPicture});return this.props.picture.length>0&&(c=React.createElement("img",{className:"img-circle",src:this.props.picture})),React.createElement("li",{className:a,onClick:this.props.select},b,c,this.props.firstName," ",this.props.lastName)}}),_extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},Single=React.createClass({displayName:"Single",getDefaultProps:function(){return{election:{},updateVote:null,vote:[],ballot:{}}},render:function(){return React.createElement(SingleBallot,_extends({singleId:this.props.ballot.id},this.props.ballot,{updateVote:this.props.updateVote,vote:this.props.vote}))}}),SingleBallot=React.createClass({displayName:"SingleBallot",getDefaultProps:function(){return{updateVote:null,title:null,tickets:[],vote:null,singleId:0}},render:function(){var a=this.props.tickets.map(function(a){return React.createElement(SingleBallotTicket,_extends({key:a.id},a,{updateVote:this.props.updateVote.bind(null,a)}))}.bind(this));return React.createElement("div",{className:"single-ticket-vote"},React.createElement("h1",null,this.props.title),React.createElement("p",{className:"warning"},"Vote for ",React.createElement("strong",null,"ONE")," ticket. We'll review your decision at the end."),a,React.createElement("hr",null),React.createElement("div",{className:"text-right"},React.createElement(AbstainButton,{title:this.props.title,handleClick:this.props.updateVote.bind(null,null)})))}}),SingleBallotTicket=React.createClass({displayName:"SingleBallotTicket",mixins:["panel"],getInitialState:function(){return{}},getDefaultProps:function(){return{title:null,platform:null,siteAddress:null,candidates:[],updateVote:null,vote:[]}},render:function(){var a=this.props.candidates.length;if(a>0)var b=this.props.candidates.map(function(b){return React.createElement(SingleCandidate,_extends({key:b.id},b,{candidateLength:a}))}.bind(this));else var b=null;var c=React.createElement("h2",null,this.props.title),d=BreakIt(this.props.platform),e=null;this.props.siteAddress.length&&(e=React.createElement("div",{className:"website"},React.createElement("a",{href:this.props.siteAddress,target:"_blank"},this.props.siteAddress," ",React.createElement("i",{className:"fa fa-external-link"}))));var f=React.createElement("div",{className:"ticket"},React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-6"},d,React.createElement("hr",null),e),b),React.createElement("button",{className:"btn btn-primary btn-block btn-lg",onClick:this.props.updateVote},React.createElement("i",{className:"fa fa-check-square-o"})," Vote for ",this.props.title));return React.createElement(Panel,{heading:c,body:f})}}),SingleCandidate=React.createClass({displayName:"SingleCandidate",getInitialState:function(){return{}},getDefaultProps:function(){return{firstName:"",lastName:"",picture:"",title:"",candidateLength:1}},render:function(){switch(this.props.candidateLength){case 1:var a="col-sm-6";break;case 2:var a="col-sm-3"}return React.createElement("div",{className:a},React.createElement("div",null,this.props.picture.length>0?React.createElement("div",{className:"photo-matte"},React.createElement("span",{className:"helper"}),React.createElement("img",{src:this.props.picture,className:"img-responsive candidate"})):React.createElement("div",{className:"no-picture text-muted"},React.createElement("i",{className:"fa fa-user fa-5x"}),React.createElement("br",null),"No picture")),React.createElement("p",null,React.createElement("strong",null,this.props.firstName," ",this.props.lastName),React.createElement("br",null),this.props.title))}}),Election=React.createClass({displayName:"Election",getInitialState:function(){return{election:null,currentSingle:0,currentMultiple:0,currentReferendum:0,single:[],multiple:[],referendum:[],ballotCount:0,referendumCount:0,stage:"loading",singleVote:[],multipleVote:[],referendumVote:[],unqualified:[],backToReview:!1,surveyLink:null,supportLink:null}},componentDidMount:function(){this.load()},load:function(){$.getJSON("election/User/Election",{command:"list"}).done(function(a){var b=this.state.stage;if(a.election)if(a.hasVoted)this.setState({stage:"finished",election:a.election});else{var c=a.single.length,d=a.multiple.length,e=a.referendum.length;b=0===c?0===d?0===e?"empty":"referendum":"multiple":"single";var f=c+d;this.setState({stage:b,hasVoted:a.hasVoted,election:a.election,single:a.single,multiple:a.multiple,referendum:a.referendum,ballotCount:f,referendumCount:e,unqualified:a.unqualified,supportLink:a.supportLink})}else this.setStage("empty")}.bind(this))},setStage:function(a){window.scrollTo(0,0),this.setState({stage:a})},getSingleKey:function(a){var b=0;return $.each(this.state.single,function(c,d){a===d.id&&(b=c)}),b},getMultipleKey:function(a){var b=0;return $.each(this.state.multiple,function(c,d){a===d.id&&(b=c)}),b},getReferendumKey:function(a){var b=0;return $.each(this.state.referendum,function(c,d){a===d.id&&(b=c)}),b},setCurrentSingle:function(a){this.setState({currentSingle:a})},setCurrentMultiple:function(a){this.setState({currentMultiple:a})},setCurrentReferendum:function(a){this.setState({currentReferendum:a})},resetStage:function(a,b){switch(a){case"single":this.setCurrentSingle(this.getSingleKey(b));break;case"multiple":this.setCurrentMultiple(this.getMultipleKey(b));break;case"referendum":this.setCurrentReferendum(this.getReferendumKey(b))}this.setState({backToReview:!0,stage:a})},updateSingleVote:function(a){var b=this.state.stage,c=this.state.currentSingle,d=c+1,e=this.state.singleVote,f=e[c];f={single:this.state.single[this.state.currentSingle],ticket:a},e[c]=f,this.state.backToReview?b="review":"undefined"==typeof this.state.single[d]&&(b=this.state.multiple.length>0?"multiple":this.state.referendum.length>0?"referendum":"review"),window.scrollTo(0,0),this.setState({stage:b,singleVote:e,currentSingle:d})},updateMultipleVote:function(a){var b=this.state.stage,c=this.state.currentMultiple,d=c+1,e=this.state.multipleVote,f=e[c];f={multiple:this.state.multiple[c],chairs:a},e[c]=f,window.scrollTo(0,0),this.state.backToReview?b="review":"undefined"==typeof this.state.multiple[d]&&(b=this.state.referendum.length>0?"referendum":"review"),this.setState({stage:b,multipleVote:e,currentMultiple:d})},updateReferendumVote:function(a){var b=this.state.stage,c=this.state.currentReferendum,d=c+1,e=this.state.referendumVote,f=e[c];f={referendum:this.state.referendum[c],answer:a},e[c]=f,window.scrollTo(0,0),this.state.backToReview?b="review":"undefined"==typeof this.state.referendum[d]&&(b="review"),this.setState({stage:b,referendumVote:e,currentReferendum:d})},finalVote:function(){var a=[];$.each(this.state.singleVote,function(b,c){c.single&&"undefined"!=typeof c.single.id&&c.ticket&&"undefined"!=typeof c.ticket.id&&a.push({singleId:c.single.id,ticketId:c.ticket.id})});var b=[];$.each(this.state.multipleVote,function(a,c){b.push({multipleId:c.multiple.id,chairs:c.chairs})});var c=[];$.each(this.state.referendumVote,function(a,b){c.push({referendumId:b.referendum.id,answer:b.answer})}),$.post("election/User/Vote",{command:"save",electionId:this.state.election.id,single:a,multiple:b,referendum:c},null,"json").done(function(a){a.success===!0?this.setState({backToReview:!1,stage:"finished",surveyLink:a.surveyLink}):this.setState({backToReview:!1,stage:"failure"})}.bind(this)).fail(function(a){this.setStage("failure")}.bind(this))},render:function(){var a=null,b=null;switch(this.state.backToReview&&(b=React.createElement("button",{className:"btn btn-lg btn-block btn-info",onClick:this.setStage.bind(null,"review")},"Return to review without saving")),this.state.stage){case"loading":a=React.createElement("div",{className:"text-center pad-top"},React.createElement("i",{className:"fa fa-spinner fa-spin fa-5x"}));break;case"empty":a=React.createElement(Empty,null);break;case"finished":a=React.createElement(Finished,{election:this.state.election,surveyLink:this.state.surveyLink});break;case"single":a=React.createElement(Single,{election:this.state.election,ballot:this.state.single[this.state.currentSingle],updateVote:this.updateSingleVote,vote:this.state.singleVote});break;case"multiple":console.log(this.state),a=React.createElement(Multiple,{election:this.state.election,ballot:this.state.multiple[this.state.currentMultiple],updateVote:this.updateMultipleVote,vote:this.state.multipleVote,unqualified:this.state.unqualified,supportLink:this.state.supportLink});break;case"referendum":a=React.createElement(Referendum,{election:this.state.election,referendum:this.state.referendum[this.state.currentReferendum],updateVote:this.updateReferendumVote,vote:this.state.referendumVote});break;case"failure":a=React.createElement(Failure,null);break;case"review":b=null,a=React.createElement(Review,{election:this.state.election,single:this.state.single,multiple:this.state.multiple,referendum:this.state.referendum,singleVote:this.state.singleVote,multipleVote:this.state.multipleVote,referendumVote:this.state.referendumVote,finalVote:this.finalVote,resetStage:this.resetStage})}var c=null;return"single"===this.state.stage&&0===this.state.singleVote.length&&0===this.state.multipleVote.length&&0===this.state.referendumVote.length&&(c=React.createElement(Countdown,{ballotCount:this.state.ballotCount,referendumCount:this.state.referendumCount})),React.createElement("div",null,c,b,a)}}),Empty=function(){return React.createElement("div",null,React.createElement("h3",null,"No elections are available. Please check back later."))},Finished=React.createClass({displayName:"Finished",getDefaultProps:function(){return{election:{},surveyLink:null}},render:function(){return React.createElement("div",{className:"row"},React.createElement("div",{className:"col-sm-6 col-sm-offset-3"},React.createElement("div",{className:"well text-center"},React.createElement("h2",null,this.props.election.title),React.createElement("h3",null,"Thank you for voting! Watch SGA for results."),React.createElement("a",{href:"./index.php?module=users&action=user&command=logout",className:"btn btn-lg btn-primary"},"Sign out"),React.createElement("hr",null),React.createElement("p",null,"What do you think about the voting process? ",React.createElement("a",{href:this.props.surveyLink},"Let us know!")))))}}),Countdown=React.createClass({displayName:"Countdown",getInitialState:function(){return{seen:!1}},getDefaultProps:function(){return{ballotCount:0,referendumCount:0,vote:null}},plural:function(a,b,c){return"undefined"!=typeof b&&0!==b.length||(b=""),"undefined"!=typeof c&&0!==c.length||(c="s"),1!=a?c:b},render:function(){var a=null,b=null,c=0,d="are",e="";return this.props.ballotCount>0&&(c+=this.props.ballotCount,a=this.props.ballotCount+" ballot"+this.plural(this.props.ballotCount)),this.props.referendumCount>0&&(c+=this.props.referendumCount,b=this.props.referendumCount+" referend"+this.plural(this.props.referendumCount,"um","a")),2>c&&(d="is"),this.props.ballotCount>0&&this.props.referendumCount>0&&(e="and"),React.createElement("div",{className:"alert alert-info"},"There ",d," currently ",a," ",e," ",b," for you to vote on. We will review all your selections later, before your votes are submitted.")}}),Failure=React.createClass({displayName:"Failure",render:function(){return React.createElement("div",null,React.createElement("h2",null,"Sorry"),React.createElement("p",null,"Your vote failed to register. Please try again or report the problem."))}});ReactDOM.render(React.createElement(Election,null),document.getElementById("election"));